name: Build and Release

on:
  push:
    tags:
      - 'v*'  # å½“æŽ¨é€ç‰ˆæœ¬æ ‡ç­¾æ—¶è§¦å‘
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘
    inputs:
      version:
        description: 'Release version'
        required: true
        default: 'v2.0.0'

jobs:
  build-windows:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Cache pip dependencies
      uses: actions/cache@v3
      with:
        path: ~\AppData\Local\pip\Cache
        key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements*.txt') }}
        restore-keys: |
          ${{ runner.os }}-pip-
          
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install -r requirements_optimized.txt
        pip install pyinstaller setuptools wheel
        
    - name: Create assets directory
      run: |
        mkdir -p assets
        echo "Assets directory created"
        
    - name: Build optimized executable
      run: |
        # åˆ›å»ºä¼˜åŒ–ç‰ˆçš„PyInstaller specæ–‡ä»¶
        python -c "
import PyInstaller.config
spec_content = '''
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

a = Analysis(
    ['start_optimized.py'],
    pathex=[],
    binaries=[],
    datas=[
        ('static', 'static'),
        ('templates', 'templates'),
        ('utils', 'utils'),
        ('version.json', '.'),
        ('requirements_optimized.txt', '.'),
    ],
    hiddenimports=[
        'fastapi',
        'uvicorn',
        'websockets',
        'aiofiles',
        'jinja2',
        'pydantic',
        'asyncio',
        'concurrent.futures',
    ],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='DocumentProcessor-Optimized',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=True,
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
)
'''
with open('build_optimized.spec', 'w') as f:
    f.write(spec_content)
"
        pyinstaller --clean --noconfirm build_optimized.spec
        
    - name: Test executable
      run: |
        if (Test-Path "dist/DocumentProcessor-Optimized.exe") {
          echo "âœ… Optimized executable created successfully"
          $size = (Get-Item "dist/DocumentProcessor-Optimized.exe").length / 1MB
          echo "ðŸ“Š File size: $([math]::Round($size, 2)) MB"
          # æµ‹è¯•åŸºæœ¬åŠŸèƒ½
          ./dist/DocumentProcessor-Optimized.exe --info
        } else {
          echo "âŒ Executable not found"
          exit 1
        }
      shell: powershell
      
    - name: Create Windows package
      run: |
        mkdir -p release
        $version = "${{ github.ref_name }}" -replace "^v", ""
        $packageName = "DocumentProcessor-Optimized-$version-win64"
        $packageDir = "release/$packageName"
        
        mkdir $packageDir
        Copy-Item "dist/DocumentProcessor-Optimized.exe" "$packageDir/"
        Copy-Item "README.md" "$packageDir/"
        Copy-Item "RELEASE.md" "$packageDir/"
        Copy-Item "requirements_optimized.txt" "$packageDir/"
        Copy-Item "version.json" "$packageDir/"
        
        # åˆ›å»ºå¯åŠ¨è„šæœ¬
        @"
@echo off
echo ðŸŽ¨ æ™ºèƒ½æ–‡æ¡£è‡ªåŠ¨æŽ’ç‰ˆç³»ç»Ÿ v2.0.0 - ä¼˜åŒ–ç‰ˆ
echo ================================================
echo.
echo è®¾ç½®APIå¯†é’¥ (å¦‚æžœè¿˜æ²¡æœ‰è®¾ç½®):
echo set OPENAI_API_KEY=your_api_key_here
echo.
echo å¯åŠ¨é€‰é¡¹:
echo [1] WebæœåŠ¡æ¨¡å¼ (æŽ¨è)
echo [2] å‘½ä»¤è¡Œæ¨¡å¼  
echo [3] æŸ¥çœ‹å¸®åŠ©
echo.
set /p choice="è¯·é€‰æ‹©æ¨¡å¼ (1-3): "

if "%choice%"=="1" (
    echo å¯åŠ¨WebæœåŠ¡...
    DocumentProcessor-Optimized.exe --web
) else if "%choice%"=="2" (
    echo å¯åŠ¨å‘½ä»¤è¡Œæ¨¡å¼...
    DocumentProcessor-Optimized.exe --cli
) else if "%choice%"=="3" (
    DocumentProcessor-Optimized.exe --info
) else (
    echo æ— æ•ˆé€‰æ‹©ï¼Œå¯åŠ¨WebæœåŠ¡æ¨¡å¼...
    DocumentProcessor-Optimized.exe --web
)
pause
"@ | Out-File -FilePath "$packageDir/å¯åŠ¨.bat" -Encoding ASCII
        
        # åˆ›å»ºä½¿ç”¨è¯´æ˜Ž
        @"
ðŸŽ¨ æ™ºèƒ½æ–‡æ¡£è‡ªåŠ¨æŽ’ç‰ˆç³»ç»Ÿ v2.0.0 - ä¼˜åŒ–ç‰ˆ

ðŸš€ å¿«é€Ÿå¼€å§‹:
1. åŒå‡»è¿è¡Œ "å¯åŠ¨.bat"
2. é€‰æ‹©è¿è¡Œæ¨¡å¼
3. æŒ‰ç…§æç¤ºæ“ä½œ

ðŸŒ WebæœåŠ¡æ¨¡å¼ (æŽ¨è):
- è®¿é—® http://localhost:8000
- çŽ°ä»£åŒ–Webç•Œé¢
- å®žæ—¶è¿›åº¦æ›´æ–°
- æ‰¹é‡å¤„ç†æ”¯æŒ

ðŸ’» å‘½ä»¤è¡Œæ¨¡å¼:
- é«˜æ•ˆå‘½ä»¤è¡Œæ“ä½œ
- è„šæœ¬åŒ–æ‰¹é‡å¤„ç†
- é€‚åˆé«˜çº§ç”¨æˆ·

ðŸ“‹ ä½¿ç”¨ç¤ºä¾‹:
- "è½¬æ¢ä¸ºçŽ°ä»£å•†åŠ¡é£Žæ ¼çš„HTMLæ–‡æ¡£ï¼Œå›¾ç‰‡åŠ åœ†è§’è¾¹æ¡†"
- "ç”Ÿæˆå­¦æœ¯è®ºæ–‡æ ¼å¼ï¼Œä½¿ç”¨è“ç™½é…è‰²æ–¹æ¡ˆ"
- "åˆ¶ä½œåˆ›æ„è®¾è®¡æ–‡æ¡£ï¼Œå›¾ç‰‡æ·»åŠ é˜´å½±æ•ˆæžœ"

âš™ï¸ çŽ¯å¢ƒè®¾ç½®:
éœ€è¦è®¾ç½® OPENAI_API_KEY çŽ¯å¢ƒå˜é‡
åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ: set OPENAI_API_KEY=your_api_key_here

ðŸ”— æ›´å¤šä¿¡æ¯:
æŸ¥çœ‹ README.md æˆ–è®¿é—® GitHub ä»“åº“
"@ | Out-File -FilePath "$packageDir/ä½¿ç”¨è¯´æ˜Ž.txt" -Encoding UTF8
        
        # åˆ›å»ºZIPåŒ…
        Compress-Archive -Path $packageDir -DestinationPath "release/$packageName.zip"
        echo "âœ… Windows package created: release/$packageName.zip"
      shell: powershell
      
    - name: Upload build artifacts
      uses: actions/upload-artifact@v3
      with:
        name: windows-executable
        path: |
          dist/DocumentProcessor-Optimized.exe
          release/*.zip
          
  build-linux:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Install system dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y build-essential
        
    - name: Install Python dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install -r requirements_optimized.txt
        pip install pyinstaller setuptools wheel
        
    - name: Build Linux executable
      run: |
        # åˆ›å»ºLinuxç‰ˆæœ¬çš„specæ–‡ä»¶
        cat > build_linux_optimized.spec << 'EOF'
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

a = Analysis(
    ['start_optimized.py'],
    pathex=[],
    binaries=[],
    datas=[
        ('static', 'static'),
        ('templates', 'templates'),
        ('utils', 'utils'),
        ('version.json', '.'),
        ('requirements_optimized.txt', '.'),
    ],
    hiddenimports=[
        'fastapi',
        'uvicorn',
        'websockets', 
        'aiofiles',
        'jinja2',
        'pydantic',
        'asyncio',
        'concurrent.futures',
    ],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='DocumentProcessor-Optimized-linux',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=True,
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
)
EOF

        pyinstaller --clean --noconfirm build_linux_optimized.spec
        
    - name: Create Linux package
      run: |
        mkdir -p release
        version=$(echo ${{ github.ref_name }} | sed 's/^v//')
        package_name="DocumentProcessor-Optimized-${version}-linux-x64"
        package_dir="release/$package_name"
        
        mkdir -p "$package_dir"
        cp "dist/DocumentProcessor-Optimized-linux" "$package_dir/"
        chmod +x "$package_dir/DocumentProcessor-Optimized-linux"
        cp README.md "$package_dir/"
        cp RELEASE.md "$package_dir/"
        cp requirements_optimized.txt "$package_dir/"
        cp version.json "$package_dir/"
        
        # åˆ›å»ºå¯åŠ¨è„šæœ¬
        cat > "$package_dir/start.sh" << 'EOF'
#!/bin/bash

echo "ðŸŽ¨ æ™ºèƒ½æ–‡æ¡£è‡ªåŠ¨æŽ’ç‰ˆç³»ç»Ÿ v2.0.0 - ä¼˜åŒ–ç‰ˆ"
echo "================================================"
echo ""
echo "è®¾ç½®APIå¯†é’¥ (å¦‚æžœè¿˜æ²¡æœ‰è®¾ç½®):"
echo "export OPENAI_API_KEY=your_api_key_here"
echo ""
echo "å¯åŠ¨é€‰é¡¹:"
echo "[1] WebæœåŠ¡æ¨¡å¼ (æŽ¨è)"
echo "[2] å‘½ä»¤è¡Œæ¨¡å¼"
echo "[3] æŸ¥çœ‹å¸®åŠ©"
echo ""
read -p "è¯·é€‰æ‹©æ¨¡å¼ (1-3): " choice

case $choice in
    1)
        echo "å¯åŠ¨WebæœåŠ¡..."
        ./DocumentProcessor-Optimized-linux --web
        ;;
    2)
        echo "å¯åŠ¨å‘½ä»¤è¡Œæ¨¡å¼..."
        ./DocumentProcessor-Optimized-linux --cli
        ;;
    3)
        ./DocumentProcessor-Optimized-linux --info
        ;;
    *)
        echo "æ— æ•ˆé€‰æ‹©ï¼Œå¯åŠ¨WebæœåŠ¡æ¨¡å¼..."
        ./DocumentProcessor-Optimized-linux --web
        ;;
esac
EOF
        chmod +x "$package_dir/start.sh"
        
        # åˆ›å»ºä½¿ç”¨è¯´æ˜Ž
        cat > "$package_dir/ä½¿ç”¨è¯´æ˜Ž.txt" << 'EOF'
ðŸŽ¨ æ™ºèƒ½æ–‡æ¡£è‡ªåŠ¨æŽ’ç‰ˆç³»ç»Ÿ v2.0.0 - ä¼˜åŒ–ç‰ˆ

ðŸš€ å¿«é€Ÿå¼€å§‹:
1. è¿è¡Œ ./start.sh
2. é€‰æ‹©è¿è¡Œæ¨¡å¼
3. æŒ‰ç…§æç¤ºæ“ä½œ

ðŸŒ WebæœåŠ¡æ¨¡å¼ (æŽ¨è):
- è®¿é—® http://localhost:8000
- çŽ°ä»£åŒ–Webç•Œé¢
- å®žæ—¶è¿›åº¦æ›´æ–°
- æ‰¹é‡å¤„ç†æ”¯æŒ

ðŸ’» å‘½ä»¤è¡Œæ¨¡å¼:
- é«˜æ•ˆå‘½ä»¤è¡Œæ“ä½œ
- è„šæœ¬åŒ–æ‰¹é‡å¤„ç†
- é€‚åˆé«˜çº§ç”¨æˆ·

ðŸ“‹ ä½¿ç”¨ç¤ºä¾‹:
- "è½¬æ¢ä¸ºçŽ°ä»£å•†åŠ¡é£Žæ ¼çš„HTMLæ–‡æ¡£ï¼Œå›¾ç‰‡åŠ åœ†è§’è¾¹æ¡†"
- "ç”Ÿæˆå­¦æœ¯è®ºæ–‡æ ¼å¼ï¼Œä½¿ç”¨è“ç™½é…è‰²æ–¹æ¡ˆ"
- "åˆ¶ä½œåˆ›æ„è®¾è®¡æ–‡æ¡£ï¼Œå›¾ç‰‡æ·»åŠ é˜´å½±æ•ˆæžœ"

âš™ï¸ çŽ¯å¢ƒè®¾ç½®:
éœ€è¦è®¾ç½® OPENAI_API_KEY çŽ¯å¢ƒå˜é‡
åœ¨ç»ˆç«¯ä¸­è¿è¡Œ: export OPENAI_API_KEY=your_api_key_here

ðŸ”— æ›´å¤šä¿¡æ¯:
æŸ¥çœ‹ README.md æˆ–è®¿é—® GitHub ä»“åº“
EOF
        
        # åˆ›å»ºTAR.GZåŒ…
        cd release
        tar -czf "$package_name.tar.gz" "$package_name"
        echo "âœ… Linux package created: release/$package_name.tar.gz"
        
    - name: Upload Linux artifacts
      uses: actions/upload-artifact@v3
      with:
        name: linux-executable
        path: release/*.tar.gz
        
  create-release:
    needs: [build-windows, build-linux]
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Download Windows artifacts
      uses: actions/download-artifact@v3
      with:
        name: windows-executable
        path: artifacts/windows/
        
    - name: Download Linux artifacts
      uses: actions/download-artifact@v3
      with:
        name: linux-executable
        path: artifacts/linux/
        
    - name: Get version from tag or input
      id: get_version
      run: |
        if [ "${{ github.event_name }}" == "workflow_dispatch" ]; then
          VERSION="${{ github.event.inputs.version }}"
        else
          VERSION=${GITHUB_REF#refs/tags/}
        fi
        echo "version=${VERSION}" >> $GITHUB_OUTPUT
        echo "Version: ${VERSION}"
        
    - name: Create release notes
      id: release_notes
      run: |
        cat > release_notes.md << 'EOF'
        # ðŸŽ‰ æ™ºèƒ½æ–‡æ¡£å¤„ç†ç³»ç»Ÿ ${{ steps.get_version.outputs.version }} - ä¼˜åŒ–ç‰ˆ
        
        ## ðŸš€ é‡å¤§æ›´æ–°
        
        ### ðŸ“ˆ æ€§èƒ½ä¼˜åŒ–
        - **ðŸ”¥ å¼‚æ­¥é«˜æ€§èƒ½å¤„ç†**: 3-5å€é€Ÿåº¦æå‡
        - **âš¡ å¹¶å‘å¤„ç†èƒ½åŠ›**: æ”¯æŒæœ€å¤§10å€å¹¶å‘æ–‡æ¡£å¤„ç†  
        - **ï¿½ å†…å­˜ä¼˜åŒ–**: 30-50%å†…å­˜ä½¿ç”¨é‡å‡å°‘
        - **ðŸ“Š ç¼“å­˜ç³»ç»Ÿ**: 80%+ç¼“å­˜å‘½ä¸­çŽ‡ï¼Œå¤§å¹…æå‡å“åº”é€Ÿåº¦
        
        ### ðŸ¤– æ™ºèƒ½åŠŸèƒ½
        - **ðŸ§  æ™ºèƒ½å†³ç­–ä»£ç†**: IntelligentDocumentAgentè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥
        - **ðŸ”„ è‡ªé€‚åº”å·¥ä½œæµ**: æ ¹æ®æ–‡æ¡£ç‰¹å¾åŠ¨æ€è°ƒæ•´å¤„ç†æµç¨‹
        - **ï¿½ è´¨é‡ä¿è¯ç³»ç»Ÿ**: QualityAssuranceAgentå¤šç»´åº¦è´¨é‡æ£€æŸ¥
        - **ðŸŽ¯ æ™ºèƒ½æŽ¨è**: åŸºäºŽå†…å®¹åˆ†æžçš„æ¨¡æ¿å’Œç­–ç•¥æŽ¨è
        
        ### ðŸŒ çŽ°ä»£Webç•Œé¢
        - **ðŸ“± å“åº”å¼è®¾è®¡**: ä½¿ç”¨Alpine.js + Tailwind CSSæž„å»º
        - **ï¿½ å®žæ—¶é€šä¿¡**: WebSocketæ”¯æŒå®žæ—¶è¿›åº¦æ›´æ–°
        - **ðŸ“Š ç³»ç»Ÿç›‘æŽ§**: è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡å’ŒçŠ¶æ€ç›‘æŽ§
        - **ðŸ‘¥ å¤šç”¨æˆ·æ”¯æŒ**: æ”¯æŒå¹¶å‘ä¼šè¯å’Œåä½œåŠŸèƒ½
        
        ## ðŸ“¦ ä¸‹è½½è¯´æ˜Ž
        
        ### Windowsç”¨æˆ·
        - **DocumentProcessor-Optimized-*-win64.zip**: Windows 64ä½ä¼˜åŒ–ç‰ˆ
        - è§£åŽ‹åŽè¿è¡Œ `å¯åŠ¨.bat` é€‰æ‹©è¿è¡Œæ¨¡å¼
        - æˆ–ç›´æŽ¥è¿è¡Œ `DocumentProcessor-Optimized.exe --web`
        
        ### Linuxç”¨æˆ·  
        - **DocumentProcessor-Optimized-*-linux-x64.tar.gz**: Linux 64ä½ä¼˜åŒ–ç‰ˆ
        - è§£åŽ‹åŽè¿è¡Œ `./start.sh` é€‰æ‹©è¿è¡Œæ¨¡å¼
        - æˆ–ç›´æŽ¥è¿è¡Œ `./DocumentProcessor-Optimized-linux --web`
        
        ## âš™ï¸ ä½¿ç”¨è¦æ±‚
        1. **APIå¯†é’¥**: éœ€è¦è®¾ç½® `OPENAI_API_KEY` çŽ¯å¢ƒå˜é‡
        2. **ç½‘ç»œè¿žæŽ¥**: éœ€è¦è¿žæŽ¥äº’è”ç½‘è°ƒç”¨AIæœåŠ¡
        3. **æ“ä½œç³»ç»Ÿ**: Windows 10+ æˆ– Linux (Ubuntu 18.04+)
        
        ## ðŸš€ å¿«é€Ÿå¼€å§‹
        
        ### WebæœåŠ¡æ¨¡å¼ (æŽ¨è)
        ```bash
        # è®¾ç½®APIå¯†é’¥
        export OPENAI_API_KEY=your_api_key_here
        
        # å¯åŠ¨WebæœåŠ¡
        ./DocumentProcessor-Optimized --web
        
        # è®¿é—® http://localhost:8000
        ```
        
        ### å‘½ä»¤è¡Œæ¨¡å¼
        ```bash
        # å•æ–‡æ¡£å¤„ç†
        ./DocumentProcessor-Optimized --cli -f document.md -i "è½¬æ¢ä¸ºçŽ°ä»£å•†åŠ¡æ ¼å¼"
        
        # æ‰¹é‡å¤„ç†
        ./DocumentProcessor-Optimized --batch --pattern "*.md" -i "ç»Ÿä¸€ä¼ä¸šæ ‡å‡†æ ¼å¼"
        ```
        
        ## ðŸ“– ä½¿ç”¨ç¤ºä¾‹
        - "è½¬æ¢ä¸ºçŽ°ä»£å•†åŠ¡é£Žæ ¼çš„HTMLæ–‡æ¡£ï¼Œå›¾ç‰‡åŠ åœ†è§’è¾¹æ¡†"
        - "ç”Ÿæˆå­¦æœ¯è®ºæ–‡æ ¼å¼çš„PDFï¼Œä½¿ç”¨è“ç™½é…è‰²"
        - "åˆ¶ä½œåˆ›æ„è®¾è®¡æ–‡æ¡£ï¼Œå›¾ç‰‡æ·»åŠ é˜´å½±æ•ˆæžœ"
        
        ## ðŸŽ¯ æ–°åŠŸèƒ½ç‰¹è‰²
        
        ### å¤„ç†ç­–ç•¥
        - **auto**: æ™ºèƒ½è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥
        - **complete**: å®Œæ•´å¤„ç†ï¼ˆåŒ…å«æ‰€æœ‰ä¼˜åŒ–ï¼‰
        - **quick**: å¿«é€Ÿå¤„ç†ï¼ˆé€‚åˆç®€å•ä»»åŠ¡ï¼‰
        - **text_only**: ä»…æ–‡æœ¬å¤„ç†
        - **analysis_focus**: åˆ†æžé‡ç‚¹æ¨¡å¼
        
        ### è¾“å‡ºæ ¼å¼
        - **HTML**: å“åº”å¼ç½‘é¡µæ–‡æ¡£
        - **PDF**: é«˜è´¨é‡PDFæ–‡æ¡£
        - **Word**: Microsoft Wordæ ¼å¼
        - **PowerPoint**: æ¼”ç¤ºæ–‡ç¨¿æ ¼å¼
        - **Markdown**: ä¼˜åŒ–çš„Markdown
        
        ## ðŸ“Š æ€§èƒ½æŒ‡æ ‡
        - **å¤„ç†é€Ÿåº¦**: < 10ç§’ï¼ˆ1000å­—ç¬¦æ–‡æ¡£ï¼‰
        - **Webå“åº”**: < 500msï¼ˆå®žæ—¶é¢„è§ˆï¼‰
        - **å¹¶å‘èƒ½åŠ›**: 100+ åŒæ—¶ä¼šè¯
        - **ç¼“å­˜å‘½ä¸­çŽ‡**: 80%+
        
        ## ðŸ› é—®é¢˜åé¦ˆ
        å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·åœ¨ [GitHub Issues](https://github.com/${{ github.repository }}/issues) ä¸­åé¦ˆ
        
        ---
        **æž„å»ºä¿¡æ¯**: 
        - æž„å»ºæ—¶é—´: $(date -u '+%Y-%m-%d %H:%M:%S UTC')
        - Gitæäº¤: ${{ github.sha }}
        - å¹³å°: Windows x64, Linux x64
        EOF
        
    - name: Create GitHub Release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: ${{ steps.get_version.outputs.version }}
        name: "æ™ºèƒ½æ–‡æ¡£å¤„ç†ç³»ç»Ÿ ${{ steps.get_version.outputs.version }} - ä¼˜åŒ–ç‰ˆ"
        body_path: release_notes.md
        draft: false
        prerelease: false
        files: |
          artifacts/windows/release/*.zip
          artifacts/linux/*.tar.gz
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    - name: Upload to Release Assets
      run: |
        echo "ðŸŽ‰ Release created successfully!"
        echo "ðŸ“¦ Assets uploaded:"
        ls -la artifacts/windows/release/ 2>/dev/null || echo "No Windows release files"
        ls -la artifacts/linux/ 2>/dev/null || echo "No Linux release files"